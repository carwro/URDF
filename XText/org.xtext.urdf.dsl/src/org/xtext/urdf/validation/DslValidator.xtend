/*
 * generated by Xtext 2.10.0
 */
package org.xtext.urdf.validation

import org.eclipse.xtext.validation.Check
import uRDF.Limit
import uRDF.Robot
import uRDF.URDFPackage

/**
 * This class contains custom validation rules. 
 *
 * See https://www.eclipse.org/Xtext/documentation/303_runtime_concepts.html#validation
 */
class DslValidator extends AbstractDslValidator {
	

	@Check
	def checkURDFComplete(Robot robot)
	{
		//robotContainsLink(robot)
		
		checkJointTypes(robot)
		
		//new ConstraintsAdapter().checkJointTypes(robot);
//		if(!checkJointParentChildRelations(robot))
//		{
//			error("Parent child problem", URDFPackage.Literals.ROBOT__JOINT)
//		} else {
//			info("Robot is valid",URDFPackage.Literals.ROBOT__LINK);
//		}
		
	}
	
	
	def checkJointParentChildRelations (Robot robot) {
      robot.getJoint.forall[j | j.getParentOf != j.getChildOf]
    }
    
	def robotContainsLink(Robot robot) {
		robot.link.length > 0
	}
	
	def checkJointTypes(Robot robot) {
		robot.joint.filter[j | j.type.getName.equals("revolute") || j.type.getName.equals("prismatic")].forall[j | j.limit != null && j.axis != null]
	}
	
}
